<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Okkhorpotrya ‚Äî Command Deck (Insane)</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg1:#05040a; --bg2:#0f0710; --neon1:#ff6ec7; --neon2:#6effc2; --neon3:#70a7ff;
      --glass: rgba(255,255,255,0.03); --muted:#b8c2d6;
      --bangla: 'Hind Siliguri', 'Inter', sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 10% 20%, rgba(111,33,255,0.06), transparent 6%), radial-gradient(900px 500px at 90% 80%, rgba(6,201,176,0.04), transparent 8%), linear-gradient(180deg,var(--bg1),var(--bg2));font-family:var(--bangla);color:#eef3ff;overflow:hidden}

    /* ---------- INSANE VISUALS (COMMAND DECK) ---------- */
    .deck{position:fixed;inset:0;display:grid;grid-template-columns:1fr 420px;gap:28px;padding:36px;align-items:stretch}

    /* Left: Work Canvas */
    .canvas{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:22px;overflow:auto;position:relative;border:1px solid rgba(255,255,255,0.03);
      box-shadow:0 40px 80px rgba(2,6,23,0.7);
    }

    /* Morphing shards background */
    .shard{position:absolute;border-radius:14px;mix-blend-mode:screen;filter:blur(24px);opacity:.16;animation:shardMove 16s ease-in-out infinite}
    .shard.s1{width:420px;height:420px;left:-80px;top:-60px;background:linear-gradient(135deg,var(--neon1),var(--neon3));transform:rotate(12deg)}
    .shard.s2{width:360px;height:360px;right:-120px;bottom:-80px;background:linear-gradient(135deg,var(--neon2),var(--neon1));transform:rotate(-18deg);animation-duration:22s}
    @keyframes shardMove{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-18px) scale(1.05)}100%{transform:translateY(0) scale(1)}}

    /* Right: Command Wheel (radial menu) */
    .wheel{
      height:100%;display:flex;flex-direction:column;gap:18px;align-items:center;justify-content:center;padding:18px
    }
    .wheel .hub{width:220px;height:220px;border-radius:50%;background:linear-gradient(135deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));display:grid;place-items:center;position:relative;border:1px solid rgba(255,255,255,0.04)}
    .hub .logo{width:110px;height:110px;border-radius:50%;background:conic-gradient(var(--neon1),var(--neon2),var(--neon3));display:grid;place-items:center;font-weight:700;color:#07101b;font-size:26px}

    .wheel .spokes{position:absolute;inset:0;pointer-events:none}
    .spoke{position:absolute;width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.02);display:grid;place-items:center;font-weight:700;color:var(--muted);cursor:pointer;transition:all .25s ease}
    .spoke:hover{transform:translateY(-8px) scale(1.06);background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));color:#fff}
    .s-1{left:50%;top:6%;transform:translate(-50%,-50%)}
    .s-2{right:6%;top:50%;transform:translate(50%,-50%)}
    .s-3{left:50%;bottom:6%;transform:translate(-50%,50%)}
    .s-4{left:6%;top:50%;transform:translate(-50%,-50%)}
    .s-5{right:16%;bottom:18%;transform:translate(0,0)}

    /* Dock ‚Äî quick access */
    .dock{position:fixed;left:50%;transform:translateX(-50%);bottom:22px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:8px;border-radius:999px;display:flex;gap:12px;border:1px solid rgba(255,255,255,0.03)}
    .dock .btn{background:transparent;padding:10px 14px;border-radius:10px;border:none;color:var(--muted);cursor:pointer}
    .dock .btn:hover{background:rgba(255,255,255,0.03);color:#fff;transform:translateY(-6px)}

    /* Cards inside canvas ‚Äî stylized like floating panels */
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:16px;margin-bottom:16px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 48px rgba(2,6,23,0.6)}
    .panel h3{font-size:18px;margin-bottom:8px}
    .meta{color:var(--muted);font-size:13px}

    /* Terminal: dramatic fullscreen overlay (keep id) */
    #terminalScreen{position:fixed;inset:0;background:linear-gradient(180deg,#02030a,rgba(4,6,23,0.96));color:#bfeec0;font-family:monospace;padding:36px;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;z-index:90}
    #terminalOutput{width:100%;max-width:1200px}
    #terminalInput{margin-top:14px;padding:12px;background:transparent;border:1px dashed rgba(255,255,255,0.04);color:inherit;border-radius:8px;width:420px}

    /* Content Area adjustments */
    #contentArea{height:100%;overflow:auto;padding:12px}

    /* Responsive */
    @media (max-width:1000px){.deck{grid-template-columns:1fr 300px}}
    @media (max-width:760px){.deck{grid-template-columns:1fr;grid-auto-rows:1fr}.wheel{order:2}.canvas{order:1;padding:14px}.dock{bottom:12px}}

    /* playful micro-animations */
    .glow{animation:glowPulse 2.8s infinite}
    @keyframes glowPulse{0%{filter:drop-shadow(0 0 0 rgba(0,0,0,0))}50%{filter:drop-shadow(0 12px 30px rgba(124,58,237,0.12))}100%{filter:drop-shadow(0 0 0 rgba(0,0,0,0))}}

    /* Bangla typography nudge */
    h1,h2,h3{font-family:var(--bangla)}
  </style>
</head>
<body>

  <!-- SHARDS -->
  <div class="shard s1"></div>
  <div class="shard s2"></div>

  <!-- MAIN COMMAND DECK LAYOUT -->
  <div class="deck">

    <!-- LEFT: Canvas (keeps contentArea id) -->
    <div class="canvas">
      <div id="contentArea">
        <!-- content injected by loadOverview/loadProfile etc. (functions kept) -->
      </div>

      <!-- floating quick cards -->
      <div style="position:absolute;right:24px;top:20px;width:240px;">
        <div class="panel" style="backdrop-filter:blur(6px);">
          <h3>Quick Draft</h3>
          <div class="meta">Create a mini post fast ‚Äî drag to upload thumbnail.</div>
          <div style="margin-top:8px;display:flex;gap:8px"><input class="input" placeholder="Title" id="quickTitle" style="flex:1"/><button class="button" id="quickSave">Save</button></div>
        </div>

        <div class="panel" style="margin-top:12px">
          <h3>Live Preview</h3>
          <div class="meta">See how your article will look on mobile.</div>
          <div id="previewBox" style="margin-top:8px;background:rgba(0,0,0,0.25);padding:8px;border-radius:8px;color:var(--muted);font-size:13px;min-height:48px">No preview yet.</div>
        </div>
      </div>

    </div>

    <!-- RIGHT: Command Wheel -->
    <aside class="wheel">
      <div class="hub glow">
        <div class="logo">‡¶ì</div>
        <div style="position:absolute;bottom:-34px;left:50%;transform:translateX(-50%);font-size:12px;color:var(--muted)">Command Deck</div>
        <div class="spokes">
          <div class="spoke s-1" id="menu-overview">üè†</div>
          <div class="spoke s-2" id="menu-profile">üë§</div>
          <div class="spoke s-3" id="menu-new">üìù</div>
          <div class="spoke s-4" id="menu-manage">üìö</div>
          <div class="spoke s-5" id="menu-stats">üìà</div>
        </div>
      </div>

      <div style="width:100%;display:flex;flex-direction:column;gap:8px;align-items:center;margin-top:12px">
        <div style="display:flex;gap:8px">
          <button class="button" id="homeBtn">Home</button>
          <button class="button" id="themeBtn">Theme</button>
        </div>
        <button class="button" id="logoutBtn" style="background:linear-gradient(90deg,var(--neon1),var(--neon2));color:#05030a">Logout</button>
      </div>
    </aside>

  </div>

  <!-- Dock -->
  <div class="dock">
    <button class="btn" id="b-new">‚úèÔ∏è New</button>
    <button class="btn" id="b-manage">üìö Manage</button>
    <button class="btn" id="b-stats">üìä Stats</button>
  </div>

  <!-- TERMINAL (keep ids and behavior) -->
  <div id="terminalScreen">
    <div id="terminalOutput"></div>
    <input id="terminalInput" autocomplete="off" placeholder="Type admin key and press Enter" />
    <span class="blinkCursor" style="display:inline-block;width:10px;height:18px;background:linear-gradient(180deg,var(--neon1),var(--neon2));margin-left:8px;border-radius:3px;"></span>
  </div>

  <!-- SCRIPT: keep functions & firebase integration intact, but adapt to new UI (IDs preserved) -->
  <script>
  /* Terminal typing */
  const terminalLines = [
    "> Initiating Command Deck...",
    "> Calibrating shards and hub...",
    "> Syncing Firebase modules...",
    "> Welcome, captain.",
    "> Enter security key:"
  ];
  let tIndex=0,charIndex=0,typingSpeed=28;
  const termOut=document.getElementById('terminalOutput'), termInput=document.getElementById('terminalInput');
  function typeLine(){
    if(tIndex>=terminalLines.length){ termInput.focus(); return; }
    const line=terminalLines[tIndex]; const current=line.substring(0,charIndex);
    if(charIndex===0) termOut.innerHTML += '<div class="terminal-line"></div>';
    termOut.lastChild.textContent=current; charIndex++;
    if(charIndex<=line.length) setTimeout(typeLine,typingSpeed); else{ tIndex++; charIndex=0; setTimeout(typeLine,260); }
  }
  setTimeout(typeLine,300);

  const correctKey='1';
  termInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ const v=termInput.value.trim(); if(v===correctKey){ document.getElementById('terminalScreen').style.display='none'; loadOverview(); } else { termOut.innerHTML += '<div class="terminal-line">> Access Denied ‚ùå</div>'; termInput.value=''; } } });

  /* Navigation bindings ‚Äî preserve function names for Firebase module */
  document.getElementById('menu-overview').onclick = () => loadOverview();
  document.getElementById('menu-profile').onclick = () => loadProfile();
  document.getElementById('menu-new').onclick = () => loadNewArticle();
  document.getElementById('menu-manage').onclick = () => loadManage();
  document.getElementById('menu-stats').onclick = () => loadStats();
  document.getElementById('homeBtn').onclick = () => window.location.href='index.html';
  document.getElementById('themeBtn').onclick = () => toggleTheme();
  document.getElementById('logoutBtn').onclick = () => { /* firebase signOut handled in module */ };
  document.getElementById('b-new').onclick = () => loadNewArticle();
  document.getElementById('b-manage').onclick = () => loadManage();
  document.getElementById('b-stats').onclick = () => loadStats();

  function toggleTheme(){ document.body.classList.toggle('dark'); localStorage.setItem('theme', document.body.classList.contains('dark')?'dark':'light'); }
  if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark');

  /* QUICK DRAFT save to inputs (non-firebase) */
  document.getElementById('quickSave').addEventListener('click',()=>{
    const t = document.getElementById('quickTitle').value.trim();
    if(!t) return alert('Title is empty');
    document.getElementById('previewBox').textContent = t;
    alert('Quick draft saved locally');
  });

  /* Keep content templates (these functions are used by Firebase script later) */
  function setActive(id){ document.querySelectorAll('.spoke').forEach(s=>s.classList.remove('active')); const el=document.getElementById(id); if(el) el.classList.add('active'); }

  function loadOverview(){ setActive('menu-overview'); const contentArea = document.getElementById('contentArea'); contentArea.innerHTML = `
    <div class="panel"><h3 style="font-family:'Hind Siliguri';">üè† Overview</h3><div class="meta">command deck overview ‚Äî quick stats & recent activity</div></div>
    <div class="panel"><h3>Recent Activity</h3><div class="meta">No recent logs.</div></div>
  `; }

  function loadProfile(){ setActive('menu-profile'); const user = JSON.parse(localStorage.getItem('loggedUser')) || {displayName:'Unknown',email:'Unknown',uid:'Unknown'}; document.getElementById('contentArea').innerHTML = `
    <div class="panel"><h3>üë§ Profile</h3><div class="meta">${user.displayName} ‚Äî ${user.email}</div></div>
  `; }

  function loadNewArticle(){ setActive('menu-new'); document.getElementById('contentArea').innerHTML = `
    <div class="panel"><h3>üìù New Article</h3>
      <div style="margin-top:8px"><label>Category</label><select id="articleCategory" class="input"><option value="">Select</option><option value="poem">Poem</option><option value="golpo">Golpo</option></select></div>
      <div style="margin-top:8px"><label>Title</label><input id="articleTitle" class="input"></div>
      <div style="margin-top:8px"><label>Content</label><textarea id="articleContent" class="input" style="min-height:140px"></textarea></div>
      <div style="margin-top:8px"><label>Thumbnail</label><input type="file" id="articleThumbnail" class="input"></div>
      <div style="margin-top:10px"><button id="publishArticle" class="button" style="background:linear-gradient(90deg,var(--neon1),var(--neon2));color:#05030a">Publish</button></div>
    </div>
  `; }

  function loadManage(){ setActive('menu-manage'); loadArticles(); }
  function loadStats(){ setActive('menu-stats'); document.getElementById('contentArea').innerHTML = `<div class="panel"><h3>üìà Stats</h3><canvas id="statsChart" style="margin-top:12px;max-width:720px"></canvas></div>`; drawChart(); }

  // expose functions for firebase script
  window.loadOverview = loadOverview; window.loadProfile = loadProfile; window.loadNewArticle = loadNewArticle; window.loadManage = loadManage; window.loadStats = loadStats; window.loadArticles = async ()=>{ /* placeholder; replaced by firebase module */ };
  window.publishArticle = async (id)=>{}; window.deleteArticle = async (id)=>{}; window.drawChart = async ()=>{};

  </script>

  <!-- FIREBASE MODULE (kept intact) -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCnFgBxGYqkMkYCTCbPPJzo8fbbZmylcHY",
    authDomain: "okkhorpotrya.firebaseapp.com",
    projectId: "okkhorpotrya",
    storageBucket: "okkhorpotrya.firebasestorage.app",
    messagingSenderId: "401210408956",
    appId: "1:401210408956:web:958c0361306121244bbc79",
    measurementId: "G-VN5XLFYH8P"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const storage = getStorage(app);
  const auth = getAuth(app);

  onAuthStateChanged(auth,(user)=>{ if(!user){ window.location.href='login.html'; return; } localStorage.setItem('loggedUser', JSON.stringify({ displayName:user.displayName||'', email:user.email||'', uid:user.uid, photoURL:user.photoURL||'' })); });

  document.getElementById('logoutBtn').onclick = async ()=>{ await signOut(auth); localStorage.removeItem('loggedUser'); window.location.href='login.html' };

  /* Publish Article (keeps original logic) */
  document.addEventListener('click', async (e)=>{
    if(e.target.id === 'publishArticle'){
      const title = document.getElementById('articleTitle').value.trim();
      const content = document.getElementById('articleContent').value.trim();
      const category = document.getElementById('articleCategory').value.trim();
      const file = document.getElementById('articleThumbnail').files[0];
      if(!title || !content || !file || !category){ alert('Please fill all fields!'); return; }
      const imgRef = ref(storage, 'thumbs/'+Date.now()+'_'+file.name);
      await uploadBytes(imgRef, file);
      const imgURL = await getDownloadURL(imgRef);
      await addDoc(collection(db,'articles'), { title, content, category, thumbnailURL: imgURL, status: 'pending', createdAt: Date.now() });
      alert('Article submitted!');
    }
  });

  /* Load Articles */
  window.loadArticles = async ()=>{
    const contentArea = document.getElementById('contentArea');
    const docsSnap = await getDocs(collection(db,'articles'));
    let html='';
    docsSnap.forEach((d)=>{ const a=d.data(); html += `
      <div style="background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:12px;border-radius:10px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;">
        <div style="display:flex;gap:12px;align-items:center;"><img src="${a.thumbnailURL}" style="width:56px;height:56px;border-radius:8px;object-fit:cover"><div><b>${a.title}</b><br><small style=\"color:var(--muted)\">Category: ${a.category}</small><br><small style=\"color:var(--muted)\">Status: ${a.status}</small></div></div>
        <div>${a.status==='pending'? `<button class=\"button\" style=\"padding:6px 10px;background:linear-gradient(90deg,var(--neon1),var(--neon2));color:#05030a\" onclick=\"publishArticle('${d.id}')\">Publish</button>` : `<span style=\"color:#16a34a;font-weight:600\">Published</span>`}<button class=\"button\" style=\"padding:6px 10px;background:#b91c1c;margin-left:6px;\" onclick=\"deleteArticle('${d.id}')\">Delete</button></div>
      </div>
    `; });
    contentArea.innerHTML = `<div class=\"panel\"><h3>üìö Manage Articles</h3><div style=\"margin-top:12px\">${html}</div></div>`;
  };

  window.publishArticle = async (id)=>{ await updateDoc(doc(db,'articles',id), { status:'published' }); loadArticles(); };
  window.deleteArticle = async (id)=>{ if(!confirm('Delete this article?')) return; await deleteDoc(doc(db,'articles',id)); loadArticles(); };

  window.drawChart = async ()=>{
    const docsSnap = await getDocs(collection(db,'articles'));
    let published=0,pending=0,poem=0,golpo=0,probondho=0,others=0;
    docsSnap.forEach((d)=>{ const a=d.data(); if(a.status==='published') published++; else pending++; if(a.category==='poem') poem++; if(a.category==='golpo') golpo++; if(a.category==='probondho') probondho++; if(a.category==='others') others++; });
    const ctx = document.getElementById('statsChart')?.getContext('2d'); if(!ctx) return;
    new Chart(ctx,{ type:'doughnut', data:{ labels:['Published','Pending','Poem','Golpo','Probondho','Others'], datasets:[{ data:[published,pending,poem,golpo,probondho,others], backgroundColor:['#16a34a','#eab308','#3b82f6','#ec4899','#a855f7','#f97316'] }] }, options:{ plugins:{legend:{position:'bottom'}}, cutout:'60%'} });
  };

  </script>

</body>
</html>
